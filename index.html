<!DOCTYPE html>
<html lang="es">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Mi primera PWA</title>

   <base href="/pwa-ejemplo1_Marina/">

   <!--Vincular el manifest -->
   <link rel="manifest" href="manifest.json">


   <!-- Color de la barra del navegador en mòviless-->
   <meta name="theme_color" content="#2196f3">

</head>
<body>
   <h1>Bienvenido a mi PWA</h1>
   <p>Se puede instalar como aplicaciòn en tu celular</p>
   <button onclick="alert('Hola desde la PWA')"> Click aqui</button>

   <ul>
        <li><a href="index.html">Inicio</a></li>
        <li><a href="login.html">Inicia sesiòn</a></li>
   </ul>
   <button id="btnInstall" hidden>Instalar app</button>

<script>
  let deferredPrompt;
  const btnInstall = document.getElementById("btnInstall");

  window.addEventListener("beforeinstallprompt", (e) => {
    // Evita que Chrome muestre el prompt automáticamente
    e.preventDefault();
    deferredPrompt = e;
    btnInstall.hidden = false;
  });

  btnInstall.addEventListener("click", () => {
    btnInstall.hidden = true;
    deferredPrompt.prompt();
    deferredPrompt.userChoice.then(choiceResult => {
      if (choiceResult.outcome === "accepted") {
        console.log("El usuario aceptó instalar");
      } else {
        console.log("El usuario canceló la instalación");
      }
      deferredPrompt = null;
    });
  });
</script>


   <!-- Registrar el Service Worker-->
    <script>
        if ("serviceWorker" in navigator){
            navigator.serviceWorker.register('/pwa-ejemplo1_Marina/sw.js')
            .then(reg => console.log("Service Worker registrado"))
            .catch(err => console.log("Error al registrar el Service Worker"))
        }
    </script>
   
</body>
</html>